from __future__ import annotations
from typing import Optional
from core.fuzzy import normalize

RETURN_LINK = "https://shop.smart.sa/p/OYDNm"
WARRANTY_LINK = "https://shop.smart.sa/ar/p/ErDop"

RETURN_KEYS = ["ุงุณุชุฑุฌุงุน", "ุงุณุชุจุฏุงู", "ุงุฑุฌุงุน", "ุงุฑุฌุน", "return", "refund", "exchange"]
WARRANTY_KEYS = ["ุถูุงู", "warranty"]

def try_answer(text: str) -> Optional[str]:
    t = normalize(text)

    if any(k in t for k in WARRANTY_KEYS):
        return (
            "ุฃููุฏ ๐ค ุจุงููุณุจุฉ ููุถูุงู:\n"
            "โข ุงูููุชุฌุงุช ุงูุฌุฏูุฏุฉ: ุถูุงู ุณูุชูู (ูุดูู ุงูุนููุจ ุงููุตูุนูุฉ).\n"
            "โข ุงูููุชุฌุงุช ุงููุณุชุนููุฉ: ุถูุงู 30 ููู.\n"
            "โข ูุง ูุดูู ุณูุก ุงูุงุณุชุฎุฏุงู/ุงูุญูุงุฏุซ/ุตูุงูุฉ ุบูุฑ ูุนุชูุฏุฉ.\n"
            f"ููุชูุงุตูู ูุงููุฉ: {WARRANTY_LINK}"
        )

    if any(k in t for k in RETURN_KEYS):
        return (
            "ุฃููุฏ ๐ค ุณูุงุณุฉ ุงูุงุณุชุฑุฌุงุน/ุงูุงุณุชุจุฏุงู ุจุงุฎุชุตุงุฑ:\n"
            "โข ุฎูุงู 7 ุฃูุงู ููููุชุฌ ุบูุฑ ุงูููุชูุญ ูุจุญุงูุชู ุงูุฃุตููุฉ.\n"
            "โข ุฅุฐุง ุงููุชุญ: ููุนุงูู ููุณุชุนูู (ุฎุตู 20โ30% ุญุณุจ ุงูุญุงูุฉ).\n"
            "โข ุงููุณุชุนูู: ูุณูุญ ุงุณุชุจุฏุงูู ุฎูุงู 30 ููู.\n"
            "โข ุงูุดุญู ุนูู ุงูุนูููุ ูุงูุฑุฌูุน/ุงูุจุฏูู ุจุนุฏ ูุญุต ุงูุทูุจ.\n"
            f"ููุชูุงุตูู ูุงููุฉ: {RETURN_LINK}"
        )

    return None
